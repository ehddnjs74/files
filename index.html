<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#111827" />
  <title>ëŒ€ê°ì„  Â· ê°ë„ ê³„ì‚°ê¸°</title>
  <link rel="manifest" href="manifest.json">
  <style>
    :root{
      --bg:#0b1020; --card:#111827; --muted:#94a3b8; --text:#e5e7eb;
      --line:#1f2937; --accent:#38bdf8; --good:#34d399; --bad:#fb7185;
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;
      background:linear-gradient(180deg, #060812, var(--bg));
      color:var(--text);
      padding:16px;
    }
    header{max-width:980px; margin:0 auto 14px auto; display:flex; gap:12px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap}
    .title{font-size:18px; font-weight:800; letter-spacing:-0.3px}
    .subtitle{font-size:12px; color:var(--muted); margin-top:2px}
    .pill{border:1px solid var(--line); border-radius:999px; padding:8px 10px; color:var(--muted); font-size:12px; background:rgba(17,24,39,0.55);}
    main{max-width:980px; margin:0 auto}
    .topbar{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin:10px 0 8px 0}
    .select, .smallbtn{
      border:1px solid var(--line); background:rgba(17,24,39,0.55); color:var(--text);
      border-radius:999px; padding:10px 12px; font-size:13px;
    }
    .smallbtn{cursor:pointer}
    .tabs{display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 12px 0;}
    button.tab{appearance:none; border:1px solid var(--line); background:rgba(17,24,39,0.55); color:var(--text);
      padding:10px 12px; border-radius:999px; font-size:13px; cursor:pointer;}
    button.tab[aria-selected="true"]{border-color:rgba(56,189,248,0.8); box-shadow:0 0 0 2px rgba(56,189,248,0.15) inset;}
    .grid{display:grid; grid-template-columns: 1fr; gap:12px;}
    @media (min-width: 920px){.grid{ grid-template-columns: 1.1fr 0.9fr; }}
    .card{background:rgba(17,24,39,0.72); border:1px solid var(--line); border-radius:var(--radius); padding:14px;
      box-shadow: 0 12px 28px rgba(0,0,0,0.25); overflow:hidden;}
    h2{margin:0 0 10px 0; font-size:16px}
    .desc{color:var(--muted); font-size:12px; line-height:1.5; margin:0 0 10px 0}
    .form{display:grid; grid-template-columns: 1fr 1fr; gap:10px;}
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}
    input{
      width:100%; padding:12px 12px; border-radius:14px; border:1px solid var(--line);
      background:rgba(2,6,23,0.35); color:var(--text); outline:none;
    }
    input:focus{ border-color: rgba(56,189,248,0.8); box-shadow:0 0 0 3px rgba(56,189,248,0.12)}
    .actions{display:flex; gap:10px; margin-top:10px; flex-wrap:wrap}
    .btn{border:1px solid var(--line); background:rgba(2,6,23,0.35); color:var(--text); padding:10px 12px; border-radius:14px; cursor:pointer; font-size:13px;}
    .btn.primary{border-color: rgba(56,189,248,0.75); background:rgba(56,189,248,0.12);}
    .result{display:grid; gap:10px;}
    .kpi{border:1px solid var(--line); border-radius:var(--radius); padding:12px; background:rgba(2,6,23,0.25);}
    .kpi .k{font-size:12px; color:var(--muted); display:flex; align-items:center; justify-content:space-between; gap:10px}
    .kpi .v{font-size:22px; font-weight:800; margin-top:6px}
    .small{font-size:12px; color:var(--muted); line-height:1.5}
    .warn{color:var(--bad)}
    .toast{position:fixed; left:50%; bottom:20px; transform:translateX(-50%); background:rgba(17,24,39,0.92); border:1px solid var(--line);
      padding:10px 12px; border-radius:14px; color:var(--text); font-size:12px; opacity:0; pointer-events:none; transition:opacity .2s ease;}
    .toast.show{opacity:1}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;}
    .svgbox{width:100%; aspect-ratio: 4/3; border-radius:var(--radius); border:1px dashed rgba(148,163,184,0.35);
      background:rgba(2,6,23,0.20); display:flex; align-items:center; justify-content:center}
    footer{max-width:980px; margin:12px auto 0 auto; color:var(--muted); font-size:11px; line-height:1.5}
  </style>
</head>
<body>
<header>
  <div>
    <div class="title">ëŒ€ê°ì„  Â· ê°ë„ ê³„ì‚°ê¸°</div>
    <div class="subtitle">ì—‘ì…€ ìˆ˜ì‹ì„ íœ´ëŒ€í°/íƒœë¸”ë¦¿ì—ì„œ ê·¸ëŒ€ë¡œ (ì˜¤í”„ë¼ì¸ ê°€ëŠ¥)</div>
  </div>
  <div class="pill">ê°ë„ ë‹¨ìœ„: <b>ë„(Â°)</b> Â· ë‚´ë¶€ì—ì„œ ë¼ë””ì•ˆ ë³€í™˜</div>
</header>

<main>
  <div class="topbar">
    <select id="precision" class="select" aria-label="í‘œì‹œ ì†Œìˆ˜ì  ìë¦¬">
      <option value="auto">í‘œì‹œ: ìë™(ìœ íš¨ìˆ«ì)</option>
      <option value="0">í‘œì‹œ: ì†Œìˆ˜ì  0ìë¦¬</option>
      <option value="1">í‘œì‹œ: ì†Œìˆ˜ì  1ìë¦¬</option>
      <option value="2" selected>í‘œì‹œ: ì†Œìˆ˜ì  2ìë¦¬</option>
      <option value="3">í‘œì‹œ: ì†Œìˆ˜ì  3ìë¦¬</option>
      <option value="4">í‘œì‹œ: ì†Œìˆ˜ì  4ìë¦¬</option>
    </select>
    <button class="smallbtn" onclick="clearHistory()">ê¸°ë¡ ì§€ìš°ê¸°</button>
    <span class="small">ê²°ê³¼ ì˜† ğŸ“‹ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë³µì‚¬ë©ë‹ˆë‹¤.</span>
  </div>

  <div class="tabs" role="tablist" aria-label="ê³„ì‚°ê¸° ì„ íƒ">
    <button class="tab" role="tab" aria-selected="true" data-tab="wh">ê°€ë¡œ+ì„¸ë¡œ</button>
    <button class="tab" role="tab" aria-selected="false" data-tab="a_h_w">ê°ë„(ê°€ë¡œ)+ë†’ì´</button>
    <button class="tab" role="tab" aria-selected="false" data-tab="a_w_w">ê°ë„(ê°€ë¡œ)+ê°€ë¡œ</button>
    <button class="tab" role="tab" aria-selected="false" data-tab="a_h_h">ê°ë„(ì„¸ë¡œ)+ë†’ì´</button>
    <button class="tab" role="tab" aria-selected="false" data-tab="d_a">ëŒ€ê°ì„ +ê°ë„(ê°€ë¡œ)</button>
  </div>

  <section id="panel-wh" class="panel">
    <div class="grid">
      <div class="card">
        <h2>ê°€ë¡œ + ì„¸ë¡œ â†’ ëŒ€ê°ì„ , ê°ë„(ê°€ë¡œ ê¸°ì¤€)</h2>
        <p class="desc">
          <span class="mono">D = âˆš(WÂ² + HÂ²)</span> Â· <span class="mono">Î¸ = degrees(atan(H/W))</span>
        </p>
        <div class="form">
          <div>
            <label for="wh_w">ê°€ë¡œ (W)</label>
            <input id="wh_w" inputmode="decimal" placeholder="ì˜ˆ: 1200" />
          </div>
          <div>
            <label for="wh_h">ì„¸ë¡œ (H)</label>
            <input id="wh_h" inputmode="decimal" placeholder="ì˜ˆ: 800" />
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" onclick="calcWH()">ê³„ì‚°</button>
          <button class="btn" onclick="resetPanel('panel-wh')">ì´ˆê¸°í™”</button>
        </div>
        <p class="small">ë‹¨ìœ„ëŠ” ììœ (ê°™ì€ ë‹¨ìœ„ë¡œë§Œ ì…ë ¥). ì˜ˆ: mm, cm, m ë“±</p>
      </div>

      <div class="card">
        <h2>ê²°ê³¼</h2>
        <div class="result">
          <div class="kpi">
            <div class="k">ëŒ€ê°ì„  (D) <button class="btn" style="padding:6px 10px" onclick="copyValue('wh_d')">ğŸ“‹</button></div>
            <div class="v" id="wh_d">â€”</div>
            <div class="small mono">D = âˆš(WÂ² + HÂ²)</div>
          </div>
          <div class="kpi">
            <div class="k">ê°ë„(ê°€ë¡œ ê¸°ì¤€ Î¸) <button class="btn" style="padding:6px 10px" onclick="copyValue('wh_a_raw')">ğŸ“‹</button></div>
            <div class="v" id="wh_a">â€”</div>
            <div class="small mono">Î¸ = degrees(atan(H/W))</div>
            <div id="wh_a_raw" hidden></div>
          </div>
          
          <div class="svgbox" aria-label="ì„¤ëª… ê·¸ë¦¼">
            <svg id="svg_wh" viewBox="0 0 400 300" width="100%" height="100%" role="img" aria-label="ì§ê°ì‚¼ê°í˜•">
              <defs>
                <marker id="svg_wh-arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
                  <path d="M0,0 L9,3 L0,6 Z" fill="rgba(148,163,184,0.95)"></path>
                </marker>
              </defs>

              <!-- Triangle (updated by JS) -->
              <g id="svg_wh-geom" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.95">
                <path id="svg_wh-tri" d="M60 240 L320 240 L320 80 Z" stroke="currentColor" stroke-width="3"/>
                <path id="svg_wh-base" d="M60 240 L320 240" stroke="rgba(52,211,153,0.95)" stroke-width="8"/>
                <path id="svg_wh-vert" d="M320 240 L320 80" stroke="rgba(52,211,153,0.95)" stroke-width="8" opacity="0.35"/>
                <path id="svg_wh-hyp" d="M60 240 L320 80" stroke="rgba(56,189,248,0.95)" stroke-width="8"/>
                <path id="svg_wh-ra" d="M300 240 L300 220 L320 220" stroke="currentColor" stroke-width="3"/>
                <path id="svg_wh-arc" d="" stroke="rgba(56,189,248,0.85)" stroke-width="6"/>
              </g>

              <!-- Labels -->
              <g fill="currentColor" font-size="14" opacity="0.95">
                <text id="svg_wh-lblW" x="190" y="265">ê°€ë¡œ(W)</text>
                <text id="svg_wh-lblH" x="330" y="165" transform="rotate(-90 330 165)">ì„¸ë¡œ(H)</text>
                <text id="svg_wh-lblD" x="150" y="140">ëŒ€ê°ì„ (D)</text>
                <text id="svg_wh-lblT" x="95" y="228">Î¸</text>
                <text id="svg_wh-cap" x="70" y="58" font-size="12" opacity="0.85">ì…ë ¥: W, H â†’ ì¶œë ¥: D, Î¸</text>
              </g>
            </svg>
          </div>


          <div class="kpi">
            <div class="k">ìµœê·¼ ê³„ì‚° ê¸°ë¡</div>
            <div class="small" id="history">â€”</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="panel-a_h_w" class="panel" hidden>
    <div class="grid">
      <div class="card">
        <h2>ê°ë„(ê°€ë¡œ ê¸°ì¤€) + ë†’ì´ â†’ ëŒ€ê°ì„ </h2>
        <p class="desc"><span class="mono">D = H / sin(radians(Î¸))</span></p>
        <div class="form">
          <div>
            <label for="ahw_a">ê°ë„ Î¸ (ê°€ë¡œ ê¸°ì¤€, Â°)</label>
            <input id="ahw_a" inputmode="decimal" placeholder="ì˜ˆ: 33.69" />
          </div>
          <div>
            <label for="ahw_h">ë†’ì´ (H)</label>
            <input id="ahw_h" inputmode="decimal" placeholder="ì˜ˆ: 800" />
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" onclick="calcAHW()">ê³„ì‚°</button>
          <button class="btn" onclick="resetPanel('panel-a_h_w')">ì´ˆê¸°í™”</button>
        </div>
        <p class="small warn" id="ahw_warn"></p>
      </div>
      <div class="card">
        <h2>ê²°ê³¼</h2>
        <div class="result">
          <div class="kpi">
            <div class="k">ëŒ€ê°ì„  (D) <button class="btn" style="padding:6px 10px" onclick="copyValue('ahw_d')">ğŸ“‹</button></div>
            <div class="v" id="ahw_d">â€”</div>
            <div class="small mono">D = H / sin(radians(Î¸))</div>
          </div>
          
          <div class="svgbox" aria-label="ì„¤ëª… ê·¸ë¦¼">
            <svg id="svg_ahw" viewBox="0 0 400 300" width="100%" height="100%" role="img" aria-label="ì§ê°ì‚¼ê°í˜•">
              <defs>
                <marker id="svg_ahw-arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
                  <path d="M0,0 L9,3 L0,6 Z" fill="rgba(148,163,184,0.95)"></path>
                </marker>
              </defs>

              <!-- Triangle (updated by JS) -->
              <g id="svg_ahw-geom" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.95">
                <path id="svg_ahw-tri" d="M60 240 L320 240 L320 80 Z" stroke="currentColor" stroke-width="3"/>
                <path id="svg_ahw-base" d="M60 240 L320 240" stroke="rgba(52,211,153,0.95)" stroke-width="8"/>
                <path id="svg_ahw-vert" d="M320 240 L320 80" stroke="rgba(52,211,153,0.95)" stroke-width="8" opacity="0.35"/>
                <path id="svg_ahw-hyp" d="M60 240 L320 80" stroke="rgba(56,189,248,0.95)" stroke-width="8"/>
                <path id="svg_ahw-ra" d="M300 240 L300 220 L320 220" stroke="currentColor" stroke-width="3"/>
                <path id="svg_ahw-arc" d="" stroke="rgba(56,189,248,0.85)" stroke-width="6"/>
              </g>

              <!-- Labels -->
              <g fill="currentColor" font-size="14" opacity="0.95">
                <text id="svg_ahw-lblW" x="190" y="265">ê°€ë¡œ(W)</text>
                <text id="svg_ahw-lblH" x="330" y="165" transform="rotate(-90 330 165)">ì„¸ë¡œ(H)</text>
                <text id="svg_ahw-lblD" x="150" y="140">ëŒ€ê°ì„ (D)</text>
                <text id="svg_ahw-lblT" x="95" y="228">Î¸</text>
                <text id="svg_ahw-cap" x="70" y="58" font-size="12" opacity="0.85">ì…ë ¥: Î¸(ê°€ë¡œê¸°ì¤€), ë†’ì´(H) â†’ ì¶œë ¥: D</text>
              </g>
            </svg>
          </div>


          <div class="small">ê°ë„ 0Â°/180Â° ê·¼ì²˜ëŠ” sin ê°’ì´ 0ì— ê°€ê¹Œì›Œ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤.</div>
        </div>
      </div>
    </div>
  </section>

  <section id="panel-a_w_w" class="panel" hidden>
    <div class="grid">
      <div class="card">
        <h2>ê°ë„(ê°€ë¡œ ê¸°ì¤€) + ê°€ë¡œ â†’ ëŒ€ê°ì„ </h2>
        <p class="desc"><span class="mono">D = W / cos(radians(Î¸))</span></p>
        <div class="form">
          <div>
            <label for="aww_a">ê°ë„ Î¸ (ê°€ë¡œ ê¸°ì¤€, Â°)</label>
            <input id="aww_a" inputmode="decimal" placeholder="ì˜ˆ: 33.69" />
          </div>
          <div>
            <label for="aww_w">ê°€ë¡œ (W)</label>
            <input id="aww_w" inputmode="decimal" placeholder="ì˜ˆ: 1200" />
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" onclick="calcAWW()">ê³„ì‚°</button>
          <button class="btn" onclick="resetPanel('panel-a_w_w')">ì´ˆê¸°í™”</button>
        </div>
        <p class="small warn" id="aww_warn"></p>
      </div>
      <div class="card">
        <h2>ê²°ê³¼</h2>
        <div class="result">
          <div class="kpi">
            <div class="k">ëŒ€ê°ì„  (D) <button class="btn" style="padding:6px 10px" onclick="copyValue('aww_d')">ğŸ“‹</button></div>
            <div class="v" id="aww_d">â€”</div>
            <div class="small mono">D = W / cos(radians(Î¸))</div>
          </div>
          
          <div class="svgbox" aria-label="ì„¤ëª… ê·¸ë¦¼">
            <svg id="svg_aww" viewBox="0 0 400 300" width="100%" height="100%" role="img" aria-label="ì§ê°ì‚¼ê°í˜•">
              <defs>
                <marker id="svg_aww-arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
                  <path d="M0,0 L9,3 L0,6 Z" fill="rgba(148,163,184,0.95)"></path>
                </marker>
              </defs>

              <!-- Triangle (updated by JS) -->
              <g id="svg_aww-geom" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.95">
                <path id="svg_aww-tri" d="M60 240 L320 240 L320 80 Z" stroke="currentColor" stroke-width="3"/>
                <path id="svg_aww-base" d="M60 240 L320 240" stroke="rgba(52,211,153,0.95)" stroke-width="8"/>
                <path id="svg_aww-vert" d="M320 240 L320 80" stroke="rgba(52,211,153,0.95)" stroke-width="8" opacity="0.35"/>
                <path id="svg_aww-hyp" d="M60 240 L320 80" stroke="rgba(56,189,248,0.95)" stroke-width="8"/>
                <path id="svg_aww-ra" d="M300 240 L300 220 L320 220" stroke="currentColor" stroke-width="3"/>
                <path id="svg_aww-arc" d="" stroke="rgba(56,189,248,0.85)" stroke-width="6"/>
              </g>

              <!-- Labels -->
              <g fill="currentColor" font-size="14" opacity="0.95">
                <text id="svg_aww-lblW" x="190" y="265">ê°€ë¡œ(W)</text>
                <text id="svg_aww-lblH" x="330" y="165" transform="rotate(-90 330 165)">ì„¸ë¡œ(H)</text>
                <text id="svg_aww-lblD" x="150" y="140">ëŒ€ê°ì„ (D)</text>
                <text id="svg_aww-lblT" x="95" y="228">Î¸</text>
                <text id="svg_aww-cap" x="70" y="58" font-size="12" opacity="0.85">ì…ë ¥: Î¸(ê°€ë¡œê¸°ì¤€), ê°€ë¡œ(W) â†’ ì¶œë ¥: D</text>
              </g>
            </svg>
          </div>


          <div class="small">90Â° ê·¼ì²˜ëŠ” cos ê°’ì´ 0ì— ê°€ê¹Œì›Œ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤.</div>
        </div>
      </div>
    </div>
  </section>

  <section id="panel-a_h_h" class="panel" hidden>
    <div class="grid">
      <div class="card">
        <h2>ê°ë„(ì„¸ë¡œ ê¸°ì¤€) + ë†’ì´ â†’ ëŒ€ê°ì„ </h2>
        <p class="desc"><span class="mono">D = H / cos(radians(Î¸))</span> (Î¸ëŠ” <b>ì„¸ë¡œ ê¸°ì¤€</b>)</p>
        <div class="form">
          <div>
            <label for="ahh_a">ê°ë„ Î¸ (ì„¸ë¡œ ê¸°ì¤€, Â°)</label>
            <input id="ahh_a" inputmode="decimal" placeholder="ì˜ˆ: 56.31" />
          </div>
          <div>
            <label for="ahh_h">ë†’ì´ (H)</label>
            <input id="ahh_h" inputmode="decimal" placeholder="ì˜ˆ: 800" />
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" onclick="calcAHH()">ê³„ì‚°</button>
          <button class="btn" onclick="resetPanel('panel-a_h_h')">ì´ˆê¸°í™”</button>
        </div>
        <p class="small">ì„¸ë¡œ ê¸°ì¤€ Î¸ â†’ ê°€ë¡œ ê¸°ì¤€ì€ <b>90Â° - Î¸</b> ì…ë‹ˆë‹¤.</p>
        <p class="small warn" id="ahh_warn"></p>
      </div>
      <div class="card">
        <h2>ê²°ê³¼</h2>
        <div class="result">
          <div class="kpi">
            <div class="k">ëŒ€ê°ì„  (D) <button class="btn" style="padding:6px 10px" onclick="copyValue('ahh_d')">ğŸ“‹</button></div>
            <div class="v" id="ahh_d">â€”</div>
            <div class="small mono">D = H / cos(radians(Î¸))</div>
          </div>
          
          <div class="svgbox" aria-label="ì„¤ëª… ê·¸ë¦¼">
            <svg id="svg_ahh" viewBox="0 0 400 300" width="100%" height="100%" role="img" aria-label="ì§ê°ì‚¼ê°í˜•">
              <defs>
                <marker id="svg_ahh-arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
                  <path d="M0,0 L9,3 L0,6 Z" fill="rgba(148,163,184,0.95)"></path>
                </marker>
              </defs>

              <!-- Triangle (updated by JS) -->
              <g id="svg_ahh-geom" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.95">
                <path id="svg_ahh-tri" d="M60 240 L320 240 L320 80 Z" stroke="currentColor" stroke-width="3"/>
                <path id="svg_ahh-base" d="M60 240 L320 240" stroke="rgba(52,211,153,0.95)" stroke-width="8"/>
                <path id="svg_ahh-vert" d="M320 240 L320 80" stroke="rgba(52,211,153,0.95)" stroke-width="8" opacity="0.35"/>
                <path id="svg_ahh-hyp" d="M60 240 L320 80" stroke="rgba(56,189,248,0.95)" stroke-width="8"/>
                <path id="svg_ahh-ra" d="M300 240 L300 220 L320 220" stroke="currentColor" stroke-width="3"/>
                <path id="svg_ahh-arc" d="" stroke="rgba(56,189,248,0.85)" stroke-width="6"/>
              </g>

              <!-- Labels -->
              <g fill="currentColor" font-size="14" opacity="0.95">
                <text id="svg_ahh-lblW" x="190" y="265">ê°€ë¡œ(W)</text>
                <text id="svg_ahh-lblH" x="330" y="165" transform="rotate(-90 330 165)">ì„¸ë¡œ(H)</text>
                <text id="svg_ahh-lblD" x="150" y="140">ëŒ€ê°ì„ (D)</text>
                <text id="svg_ahh-lblT" x="95" y="228">Î¸</text>
                <text id="svg_ahh-cap" x="70" y="58" font-size="12" opacity="0.85">ì…ë ¥: Î¸(ì„¸ë¡œê¸°ì¤€), ë†’ì´(H) â†’ ì¶œë ¥: D</text>
              </g>
            </svg>
          </div>


        </div>
      </div>
    </div>
  </section>

  <section id="panel-d_a" class="panel" hidden>
    <div class="grid">
      <div class="card">
        <h2>ëŒ€ê°ì„  + ê°ë„(ê°€ë¡œ ê¸°ì¤€) â†’ ë†’ì´, ê°€ë¡œ</h2>
        <p class="desc">
          <span class="mono">H = D * sin(radians(Î¸))</span> Â· <span class="mono">W = D * cos(radians(Î¸))</span>
        </p>
        <div class="form">
          <div>
            <label for="da_d">ëŒ€ê°ì„  (D)</label>
            <input id="da_d" inputmode="decimal" placeholder="ì˜ˆ: 1442.22" />
          </div>
          <div>
            <label for="da_a">ê°ë„ Î¸ (ê°€ë¡œ ê¸°ì¤€, Â°)</label>
            <input id="da_a" inputmode="decimal" placeholder="ì˜ˆ: 33.69" />
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" onclick="calcDA()">ê³„ì‚°</button>
          <button class="btn" onclick="resetPanel('panel-d_a')">ì´ˆê¸°í™”</button>
        </div>
      </div>
      <div class="card">
        <h2>ê²°ê³¼</h2>
        <div class="result">
          <div class="kpi">
            <div class="k">ë†’ì´ (H) <button class="btn" style="padding:6px 10px" onclick="copyValue('da_h')">ğŸ“‹</button></div>
            <div class="v" id="da_h">â€”</div>
            <div class="small mono">H = D * sin(radians(Î¸))</div>
          </div>
          <div class="kpi">
            <div class="k">ê°€ë¡œ (W) <button class="btn" style="padding:6px 10px" onclick="copyValue('da_w')">ğŸ“‹</button></div>
            <div class="v" id="da_w">â€”</div>
            <div class="small mono">W = D * cos(radians(Î¸))</div>
          </div>
          
          <div class="svgbox" aria-label="ì„¤ëª… ê·¸ë¦¼">
            <svg id="svg_da" viewBox="0 0 400 300" width="100%" height="100%" role="img" aria-label="ì§ê°ì‚¼ê°í˜•">
              <defs>
                <marker id="svg_da-arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
                  <path d="M0,0 L9,3 L0,6 Z" fill="rgba(148,163,184,0.95)"></path>
                </marker>
              </defs>

              <!-- Triangle (updated by JS) -->
              <g id="svg_da-geom" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.95">
                <path id="svg_da-tri" d="M60 240 L320 240 L320 80 Z" stroke="currentColor" stroke-width="3"/>
                <path id="svg_da-base" d="M60 240 L320 240" stroke="rgba(52,211,153,0.95)" stroke-width="8"/>
                <path id="svg_da-vert" d="M320 240 L320 80" stroke="rgba(52,211,153,0.95)" stroke-width="8" opacity="0.35"/>
                <path id="svg_da-hyp" d="M60 240 L320 80" stroke="rgba(56,189,248,0.95)" stroke-width="8"/>
                <path id="svg_da-ra" d="M300 240 L300 220 L320 220" stroke="currentColor" stroke-width="3"/>
                <path id="svg_da-arc" d="" stroke="rgba(56,189,248,0.85)" stroke-width="6"/>
              </g>

              <!-- Labels -->
              <g fill="currentColor" font-size="14" opacity="0.95">
                <text id="svg_da-lblW" x="190" y="265">ê°€ë¡œ(W)</text>
                <text id="svg_da-lblH" x="330" y="165" transform="rotate(-90 330 165)">ì„¸ë¡œ(H)</text>
                <text id="svg_da-lblD" x="150" y="140">ëŒ€ê°ì„ (D)</text>
                <text id="svg_da-lblT" x="95" y="228">Î¸</text>
                <text id="svg_da-cap" x="70" y="58" font-size="12" opacity="0.85">ì…ë ¥: D, Î¸(ê°€ë¡œê¸°ì¤€) â†’ ì¶œë ¥: W, H</text>
              </g>
            </svg>
          </div>


          <div class="small">ê°ë„ ê¸°ì¤€ì€ <b>ê°€ë¡œ ê¸°ì¤€</b>ì…ë‹ˆë‹¤.</div>
        </div>
      </div>
    </div>
  </section>
</main>

<footer>
  <div>Â· ì•ˆë“œë¡œì´ë“œ í¬ë¡¬: ë©”ë‰´(â‹®) â†’ <b>í™ˆ í™”ë©´ì— ì¶”ê°€</b>ë¡œ ì„¤ì¹˜í•˜ë©´ ì•±ì²˜ëŸ¼ ì‹¤í–‰ë©ë‹ˆë‹¤.</div>
  <div>Â· ì˜¤í”„ë¼ì¸: í•œ ë²ˆ ì—´ì–´ë‘ë©´ ì´í›„ ì¸í„°ë„· ì—†ì´ë„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤(PWA ìºì‹œ).</div>
</footer>

<div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
  // PWA
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js').catch(()=>{});
    });
  }

  // Tabs
  const tabs = document.querySelectorAll('button.tab');
  const panels = {
    wh: document.getElementById('panel-wh'),
    a_h_w: document.getElementById('panel-a_h_w'),
    a_w_w: document.getElementById('panel-a_w_w'),
    a_h_h: document.getElementById('panel-a_h_h'),
    d_a: document.getElementById('panel-d_a')
  };
  tabs.forEach(t => t.addEventListener('click', () => {
    tabs.forEach(x => x.setAttribute('aria-selected', 'false'));
    t.setAttribute('aria-selected','true');
    const key = t.dataset.tab;
    Object.entries(panels).forEach(([k, el]) => el.hidden = (k !== key));
  }));

  // Helpers
  function num(id){
    const v = document.getElementById(id).value.trim().replaceAll(',','');
    if (v === '') return NaN;
    return Number(v);
  }
  function precisionMode(){
    return document.getElementById('precision').value;
  }
  function fmt(x){
    if (!isFinite(x)) return 'â€”';
    const mode = precisionMode();
    if (mode === 'auto'){
      const abs = Math.abs(x);
      let s = (abs >= 1 ? x.toPrecision(6) : x.toPrecision(6));
      if (s.includes('e')) return s;
      return String(Number(s));
    } else {
      const n = Number(mode);
      return x.toFixed(n);
    }
  }
  function deg2rad(d){ return d * Math.PI / 180; }

  // ===== Dynamic SVG (ê°ë„ì— ë§ëŠ” ë°©í–¥ìœ¼ë¡œ ì‚¼ê°í˜• í‘œì‹œ) =====
  function clamp(x, a, b){ return Math.max(a, Math.min(b, x)); }

  // Draw a right triangle with given theta (0~89.9 deg) referenced from horizontal base at the left.
  // It scales to fit the viewBox.
  function drawTriangle(svgId, thetaDeg, mode, thetaDisplayDeg=null, thetaRef='h'){
    const svg = document.getElementById(svgId);
    if (!svg || !isFinite(thetaDeg)) return;

    // Safe theta
    let t = clamp(thetaDeg, 0.1, 89.9);
    const rad = deg2rad(t);

    // Base length and height from theta, then scale to fit
    const base0 = 240; // nominal base
    const h0 = base0 * Math.tan(rad);

    // Fit into box: left bottom (60,240), max x 340, max y 260, min y 70
    const x0 = 60, y0 = 240;
    const maxX = 340, minY = 70;

    // Determine scale so that apex y stays above minY and right x stays before maxX
    const maxBase = maxX - x0;
    const maxH = y0 - minY;
    const scale = Math.min(maxBase / base0, maxH / h0);

    const base = base0 * scale;
    const h = h0 * scale;

    const x1 = x0 + base, y1 = y0;      // right-bottom
    const x2 = x1, y2 = y0 - h;         // right-top (apex)

    // Update paths
    const tri = document.getElementById(svgId + '-tri');
    const baseP = document.getElementById(svgId + '-base');
    const vertP = document.getElementById(svgId + '-vert');
    const hypP = document.getElementById(svgId + '-hyp');
    const ra = document.getElementById(svgId + '-ra');
    const arc = document.getElementById(svgId + '-arc');

    if (tri) tri.setAttribute('d', `M${x0} ${y0} L${x1} ${y1} L${x2} ${y2} Z`);
    if (baseP) baseP.setAttribute('d', `M${x0} ${y0} L${x1} ${y1}`);
    if (vertP) vertP.setAttribute('d', `M${x1} ${y1} L${x2} ${y2}`);
    if (hypP) hypP.setAttribute('d', `M${x0} ${y0} L${x2} ${y2}`);

    // Right angle mark at (x1,y1)
    if (ra) ra.setAttribute('d', `M${x1-20} ${y1} L${x1-20} ${y1-20} L${x1} ${y1-20}`);

    // Theta arc
    // - ê¸°ë³¸(h): ì¢Œí•˜ë‹¨(ê°€ë¡œ ê¸°ì¤€)
    // - ì„¸ë¡œ ê¸°ì¤€(v): ìš°ìƒë‹¨(ì„¸ë¡œ ê¸°ì¤€)ì—ì„œ í‘œì‹œ
    if (arc){
      const r = 32;
      if (thetaDisplayDeg === null) thetaDisplayDeg = thetaDeg;

      if (thetaRef === 'v'){
        // vertex at apex (x2,y2). draw arc from vertical-down (90Â°) to hypotenuse direction.
        const vAng = Math.PI/2; // vertical down in screen coords
        const hypAng = Math.atan2((y0 - y2), (x0 - x2)); // from apex to left-bottom
        // points on the two rays
        const ax = x2 + r * Math.cos(vAng);
        const ay = y2 + r * Math.sin(vAng);
        const bx = x2 + r * Math.cos(hypAng);
        const by = y2 + r * Math.sin(hypAng);
        // sweep: draw the small arc between the rays
        arc.setAttribute('d', `M${ax} ${ay} A${r} ${r} 0 0 1 ${bx} ${by}`);
      } else {
        // horizontal reference at left-bottom
        const radDisp = deg2rad(clamp(thetaDisplayDeg, 0.1, 89.9));
        const ax = x0 + r * Math.cos(0);
        const ay = y0 - r * Math.sin(0);
        const bx = x0 + r * Math.cos(radDisp);
        const by = y0 - r * Math.sin(radDisp);
        arc.setAttribute('d', `M${ax} ${ay} A${r} ${r} 0 0 0 ${bx} ${by}`);
      }
    }

    // Label positions roughly follow geometry
    const lblW = document.getElementById(svgId + '-lblW');
    const lblH = document.getElementById(svgId + '-lblH');
    const lblD = document.getElementById(svgId + '-lblD');
    const lblT = document.getElementById(svgId + '-lblT');

    if (lblW){ lblW.setAttribute('x', String((x0+x1)/2 - 20)); lblW.setAttribute('y', String(y0 + 25)); }
    if (lblH){ lblH.setAttribute('x', String(x1 + 18)); lblH.setAttribute('y', String((y0+y2)/2 + 10)); lblH.setAttribute('transform', `rotate(-90 ${x1+18} ${(y0+y2)/2 + 10})`); }
    if (lblD){ lblD.setAttribute('x', String((x0+x2)/2 - 10)); lblD.setAttribute('y', String((y0+y2)/2 - 8)); }
    if (lblT){
      if (thetaRef === 'v'){
        lblT.setAttribute('x', String(x2 - 28));
        lblT.setAttribute('y', String(y2 + 38));
      } else {
        lblT.setAttribute('x', String(x0 + 32));
        lblT.setAttribute('y', String(y0 - 12));
      }
    }

    // Mode-specific highlighting
    const setStroke = (el, color, op=1) => { if (!el) return; el.style.stroke = color; el.style.opacity = op; };
    // default
    setStroke(baseP, 'rgba(148,163,184,0.45)', 1);
    setStroke(vertP, 'rgba(148,163,184,0.45)', 1);
    setStroke(hypP, 'rgba(148,163,184,0.45)', 1);

    if (mode === 'wh'){ // both known: highlight all gently, hyp stronger
      setStroke(baseP, 'rgba(52,211,153,0.85)', 1);
      setStroke(vertP, 'rgba(52,211,153,0.35)', 1);
      setStroke(hypP, 'rgba(56,189,248,0.95)', 1);
    } else if (mode === 'ahw'){ // input H + theta -> D
      setStroke(vertP, 'rgba(52,211,153,0.95)', 1);
      setStroke(hypP, 'rgba(56,189,248,0.95)', 1);
      setStroke(baseP, 'rgba(148,163,184,0.35)', 1);
    } else if (mode === 'aww'){ // input W + theta -> D
      setStroke(baseP, 'rgba(52,211,153,0.95)', 1);
      setStroke(hypP, 'rgba(56,189,248,0.95)', 1);
      setStroke(vertP, 'rgba(148,163,184,0.35)', 1);
    } else if (mode === 'ahh'){ // vertical-theta input: show same triangle but caption differs
      setStroke(vertP, 'rgba(52,211,153,0.95)', 1);
      setStroke(hypP, 'rgba(56,189,248,0.95)', 1);
      setStroke(baseP, 'rgba(148,163,184,0.35)', 1);
    } else if (mode === 'da'){ // input D+theta -> outputs W,H
      setStroke(hypP, 'rgba(52,211,153,0.95)', 1);
      setStroke(baseP, 'rgba(56,189,248,0.85)', 1);
      setStroke(vertP, 'rgba(56,189,248,0.35)', 1);
    }
  }
  function setWarn(id, msg){
    const el = document.getElementById(id);
    if (!el) return;
    el.textContent = msg || '';
  }
  function toast(msg){
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    setTimeout(()=>t.classList.remove('show'), 1300);
  }
  async function copyValue(id){
    const el = document.getElementById(id);
    const text = (el?.textContent || '').replace('â€”','').trim();
    if (!text){ toast('ë³µì‚¬í•  ê°’ì´ ì—†ìŠµë‹ˆë‹¤'); return; }
    try{
      await navigator.clipboard.writeText(text);
      toast('ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤');
    }catch(e){
      // fallback
      const ta = document.createElement('textarea');
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      document.execCommand('copy');
      ta.remove();
      toast('ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤');
    }
  }

  // History (localStorage)
  function addHistory(line){
    const key = 'diag_hist_v1';
    const cur = JSON.parse(localStorage.getItem(key) || '[]');
    cur.unshift({t: Date.now(), line});
    const next = cur.slice(0, 8);
    localStorage.setItem(key, JSON.stringify(next));
    renderHistory();
  }
  function renderHistory(){
    const key = 'diag_hist_v1';
    const cur = JSON.parse(localStorage.getItem(key) || '[]');
    const box = document.getElementById('history');
    if (!box) return;
    if (!cur.length){ box.textContent = 'â€”'; return; }
    const lines = cur.map(x => {
      const d = new Date(x.t);
      const hh = String(d.getHours()).padStart(2,'0');
      const mm = String(d.getMinutes()).padStart(2,'0');
      return `(${hh}:${mm}) ${x.line}`;
    });
    box.innerHTML = lines.map(s => `<div class="mono">${escapeHtml(s)}</div>`).join('');
  }
  function clearHistory(){
    localStorage.removeItem('diag_hist_v1');
    renderHistory();
    toast('ê¸°ë¡ì„ ì§€ì› ìŠµë‹ˆë‹¤');
  }
  function escapeHtml(s){
    return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');
  }

  function resetPanel(panelId){
    document.querySelectorAll('#'+panelId+' input').forEach(i => i.value='');
    // ê²°ê³¼ëŠ” ìœ ì§€
    toast('ì…ë ¥ì„ ì´ˆê¸°í™”í–ˆìŠµë‹ˆë‹¤');
  }

  // Calculators
  function calcWH(){
    const W = num('wh_w'), H = num('wh_h');
    const D = Math.hypot(W, H);
    const A = Math.atan2(H, W) * 180 / Math.PI;
    document.getElementById('wh_d').textContent = fmt(D);
    document.getElementById('wh_a').textContent = fmt(A) + 'Â°';
    document.getElementById('wh_a_raw').textContent = fmt(A);
    drawTriangle('svg_wh', A, 'wh');
    addHistory(`W=${fmt(W)}, H=${fmt(H)} â†’ D=${fmt(D)}, Î¸=${fmt(A)}Â°`);
  }

  function calcAHW(){
    setWarn('ahw_warn','');
    const A = num('ahw_a'), H = num('ahw_h');
    const s = Math.sin(deg2rad(A));
    if (!isFinite(s) || Math.abs(s) < 1e-6){
      setWarn('ahw_warn','âš  sin(Î¸)ê°€ 0ì— ê°€ê¹Œì›Œ ê³„ì‚°ì´ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤. ê°ë„ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
    }
    const D = H / s;
    document.getElementById('ahw_d').textContent = fmt(D);
    drawTriangle('svg_ahw', A, 'ahw');
    addHistory(`Î¸=${fmt(A)}Â°, H=${fmt(H)} â†’ D=${fmt(D)}`);
  }

  function calcAWW(){
    setWarn('aww_warn','');
    const A = num('aww_a'), W = num('aww_w');
    const c = Math.cos(deg2rad(A));
    if (!isFinite(c) || Math.abs(c) < 1e-6){
      setWarn('aww_warn','âš  cos(Î¸)ê°€ 0ì— ê°€ê¹Œì›Œ ê³„ì‚°ì´ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤(90Â° ê·¼ì²˜). ê°ë„ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
    }
    const D = W / c;
    document.getElementById('aww_d').textContent = fmt(D);
    drawTriangle('svg_aww', A, 'aww');
    addHistory(`Î¸=${fmt(A)}Â°, W=${fmt(W)} â†’ D=${fmt(D)}`);
  }

  function calcAHH(){
    setWarn('ahh_warn','');
    const A = num('ahh_a'), H = num('ahh_h');
    const c = Math.cos(deg2rad(A));
    if (!isFinite(c) || Math.abs(c) < 1e-6){
      setWarn('ahh_warn','âš  cos(Î¸)ê°€ 0ì— ê°€ê¹Œì›Œ ê³„ì‚°ì´ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤. ê°ë„ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
    }
    const D = H / c;
    document.getElementById('ahh_d').textContent = fmt(D);
    const Ah = 90 - A;
    drawTriangle('svg_ahh', Ah, 'ahh', A, 'v');
    addHistory(`(ì„¸ë¡œê¸°ì¤€)Î¸=${fmt(A)}Â°, H=${fmt(H)} â†’ D=${fmt(D)}`);
  }

  function calcDA(){
    const D = num('da_d'), A = num('da_a');
    const H = D * Math.sin(deg2rad(A));
    const W = D * Math.cos(deg2rad(A));
    document.getElementById('da_h').textContent = fmt(H);
    document.getElementById('da_w').textContent = fmt(W);
    drawTriangle('svg_da', A, 'da');
    addHistory(`D=${fmt(D)}, Î¸=${fmt(A)}Â° â†’ H=${fmt(H)}, W=${fmt(W)}`);
  }

  // init
  renderHistory();
  // default previews
  drawTriangle('svg_wh', 35, 'wh');
  drawTriangle('svg_ahw', 35, 'ahw');
  drawTriangle('svg_aww', 35, 'aww');
  drawTriangle('svg_ahh', 35, 'ahh', 55, 'v');
  drawTriangle('svg_da', 35, 'da');
</script>
</body>
</html>
